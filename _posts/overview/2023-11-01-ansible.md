---
layout: post
title:  Ansible
img: '<svg class="svg-icon svg-icon-cust" viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg"><path d="M14.156 15.297l6.25 4.927-4.141-10.214zM16 0c-8.839 0-16 7.161-16 16s7.161 16 16 16c8.839 0 16-7.161 16-16s-7.161-16-16-16zM23.729 23.073c-0.016 0.63-0.536 1.125-1.167 1.109-0.313 0-0.552-0.12-0.885-0.391l-8.255-6.667-2.771 6.938h-2.396l6.995-16.807c0.167-0.422 0.568-0.693 1.021-0.677 0.432-0.016 0.839 0.25 0.99 0.677l6.365 15.323c0.057 0.151 0.104 0.313 0.104 0.464 0 0.010 0 0.010 0 0.031z"/></svg>'
tags: ansible overview devops lab
---

Primarily used in lab to provision virtual machines running Ubuntu that have been deployed to Proxmox via Terraform.

## Details

### Roles

To facilitate this setup, I manage a variety of custom roles. These roles are responsible for handling distinct aspects of the configuration. Alongside these roles, I maintain several playbooks. Each playbook is designed to execute specific roles on designated targets.

To illustrate, if I need to provision a new cluster of virtual machines, I can execute a concise playbook. However, this would require minor adjustments to the IP address values within some of the role files.

This playbook would result in any hosts in the `servers`, and `workers` groups
being provisioned with the `hashi`, `consul`, `nomad`, and `docker` roles. (ie 
installing the Hashicorp repository, install and configure Consul and Nomad, and finally install Docker).

```yml
---
- name: Setup cluster
  hosts:
    - servers
    - workers
  roles:
    - hashi
    - consul
    - nomad
    - docker
  tags:
    - setup
```

### Other Uses

I've also used ansible in settings beyond VMs. For example, I've used it with Packer to provision custom Docker images, provision Coder templates, as part of the setup flow for my personal dotfiles, and to execute tasks on hosts on my LAN.

## Reference

>Ansible provides open-source automation that reduces complexity and runs everywhere. Using Ansible lets you automate virtually any task.

- [Ansible Home](https://www.ansible.com/)
- [Ansible Docs](https://docs.ansible.com/ansible/latest/index.html)

{% include refs.md %}