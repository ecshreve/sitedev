---
layout: post
rank: 1
title: Lab
permalink: /projects/lab/
image: assets/images/lab-cur.png
tags: lab devops ansible terraform proxmox docker nomad consul linux
---

I started my homelab with an old desktop and then brought in a Synology NAS, initially 
focusing on media management and Plex. Since then I've tried all sorts of hardware and
software configurations out, and the setup has evolved into a more general-purpose lab.

## Network

Currently all wired hosts in lab are connected to a 24 port Ubiquiti switch, which uplinks to a 
Ubiquiti Dream Router via a Ubuiquiti AP configured as a wireless bridge. A dedicated SSID provides
wireless access to the lab's network.

<br/>

{% include hardware.html hostname = "olympus" %}

{% include hardware.html hostname = "athena" %}

<br/>

## Servers // Compute

The lab's main compute resources are two Lenovo Mini PCs, `srv-1` running Proxmox VE, and
`coderbox` running Ubuntu 22.04. Coderbox is running Coder[^coder-docs] as a system service, 
and is used for most of my day today development. 

<br/>

{% include hardware.html hostname = "coderbox" %}

<br/>

Srv-1 is running Proxmox VE, providing a virtualization platform for the lab. It's
running a number of Ubuntu VMs, their resource definitions are mananged via Terraform
and they're provisioned with Ansible. For more information on that part of the lab,
see the [devops](#devops) section below.

<br/>

{% include hardware.html hostname = "srv-1" %}

<br/>

## Network Attached Storage

Two Synology NAS units store most of everything, in addition to handling some
core services used by the lab. Vault is the primary NAS, while Knossus maintains backups and stores logs. Both are connected to a Ubiquiti 24-port switch, which uplinks wirelessly to a Ubiquiti Dream Router and the internet.

<br/>

Vault runs a local DNS server and reverse proxy allowing me to use hostnames instead of IPs to access locally hosted applications and machines. It also shares a number of folders via NFS that are mounted elsewhere in the lab.

<br/>

{% include hardware.html hostname = "vault" %}

{% include hardware.html hostname = "knossus" %}

<br/>

## Appendix

In the past these two Dell servers ran mainly LXC containers and are now retired. They were
way overpowered for what I was doing with them, but I got them for a good price
and it was fun to have 60 CPU cores and 120 gigs of RAM for awhile.

<br/>

{% include hardware.html hostname = "apollo" %}

{% include hardware.html hostname = "artemis" %}

<br/>

Vault was the first piece of hardware I purchased for lab type purposes, and it's been
running strong for 4 years. Here's a list of some of the things I've done with it in the past:

- Ran a Plex server
- Ran Docker environment for lab version 1 where I was managing everything in one big docker compose file, and later with docker swarm
- Exported metrics to Prometheus via SNMP and node_exporter
- Ran a VPN server for remote access
- Used official Synology apps to manage backups of local machines, and to sync files between machines, as well as dumping backups to S3 glacier storage
- Ran a local mail server
- Run syslog server for centrally location logs

## Devops

[Ansible](/overview/ansible), [Terraform](/overview/terraform), and [Docker](/overview/docker), are my main tools when it comes to workload orchestration and configuration automation.

### Diagrams

[![Lab Current](/assets/images/projects/lab-cur.png)](/assets/images/projects/lab-cur.png)

<br/>

[![Lab Previous Iteration](/assets/images/projects/lab-old.png)](/assets/images/projects/lab-old.png)

{% include refs.md %}
